---
title: TS Check 与 JSDoc
number: '#378'
link: 'https://github.com/tofrankie/blog/issues/378'
created_at: '2025-11-26 11:02:14'
updated_at: '2025-11-26 11:42:02'
labels:
  - 前端
  - '2022'
---
## 参考链接

- [@use JSDoc](https://jsdoc.app/)
- [Working with JavaScript](https://code.visualstudio.com/docs/nodejs/working-with-javascript#_type-checking-javascript)
- [JS Projects Utilizing TypeScript](https://www.typescriptlang.org/docs/handbook/intro-to-js-ts.html)

VS Code 中 JavaScript 文件的代码提示是基于 TypeScript 实现的。

TypeScript 不完全支持所有的 JSDoc 标签，具体请看：[JSDoc Reference](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html)。

JavaScript 中的类型检查可使用 JSDoc 注释来增强。

## JS 类型检查

在项目根目录下添加 tsconfig.json 或 jsconfig.json 配置文件，以启动对项目中 JavaScript 文件的类型检查。

如果只是想要 TS 静态类型检查的能力，可能还需要指定 onEmit 等编译选项，更多请看：[TSConfig Reference](https://www.typescriptlang.org/tsconfig)。

这样的话，安装好 [typescript](https://www.npmjs.com/package/typescript) 依赖，执行 tsc 便可对项目进行检查。

tsconfig.json

```json
{
  "compilerOptions": {
    "allowJs": true,
    "checkJs": true
  },
  "include": ["xxx"],
  "exclude": ["xxx"]
}
```

## JSDoc

目前 TS 可识别以下这些 JSDoc 注释。对应示例可看 JSDoc Reference。

Types
- [@type](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#type)
- [@param](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#param-and-returns) (or [@arg](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#param-and-returns) or [@argument](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#param-and-returns))
- [@returns](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#param-and-returns) (or [@return](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#param-and-returns))
- [@typedef](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#typedef-callback-and-param)
- [@callback](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#typedef-callback-and-param)
- [@template](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#template)

Classes
- [Property Modifiers](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#property-modifiers) @public, @private, @protected, @readonly
- [@override](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#override)
- [@extends](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#extends) (or [@augments](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#extends))
- [@implements](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#implements)
- [@class](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#constructor) (or [@constructor](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#constructor))
- [@this](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#this)

Documentation
- [@deprecated](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#deprecated)
- [@see](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#see)
- [@link](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#link)

Other
- [@enum](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#enum)
- [@author](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#author)
- [Other supported patterns](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#other-supported-patterns)（特别留意下）
- [Unsupported patterns](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#unsupported-patterns)（特别留意下）
- [Unsupported tags](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#unsupported-tags)（特别留意下）

## 示例

### 断言

形式：`/** @type {!MyType} */ (valueExpression)`

> 必须要有圆括号，否则断言无效！

常量断言

```js
const STATUS = /** @type {const} */ ({
  PENDING: 'pending'
})
```

### 导入

定义可复用的类型：

```js
/**
 * @typedef {import("react").CSSProperties} CSSProperties
 * @typedef {import("react").HTMLAttributes} HTMLAttributes
 */

/**
 * @param {CSSProperties} styles
 */
function getStyle(styles) {}

/**
 * @param {HTMLAttributes} attrs
 */
function getAttrs(attrs) {}
```

从 TypeScript 5.5 起，可以直接在 JSDoc 中导入一组类型，不再需要使用 @typedef 定义一系列的类型：

```js
/** @import { CSSProperties, HTMLAttributes } from "react" */

/**
 * @param {CSSProperties} styles
 */
function getStyle(styles) {}

/**
 * @param {HTMLAttributes} attrs
 */
function getAttrs(attrs) {}
```

更多：[The JSDoc @import Tag](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-5-5.html#the-jsdoc-import-tag)

### 函数

函数表达式

```js
/**
 * @type {function (number, number): number} 
 */
const sum = (x, y) => x + y
```

函数声明

```js
/** 
 * @name fn 
 * @param {string} str 
 * @param {boolean} flag 
 * @returns {*[]} 
 */
function fn(str, flag) {
  return []
}
```

未完待续...
